import{Extension,Config,Styles}from"../js/es6/mediaviewer-extension.js";import{startup,VideoPlayer,AudioPlayer,Gallery,Carousel}from"../js/es6/mediaviewer.js";import{uniqueid,parseBoolean}from"../js/es6/mediaviewer-tools.js";startup();export const autoloader=class extends Extension{constructor(t,e,a){super(t,(new Config).parse(e),(new Styles).parse(a))}};window.addEventListener("load",(()=>{let t,e,a,r;document.querySelectorAll("[media-video-player], [media-audio-player], [media-gallery], [media-carousel]").forEach((i=>{i.id||(i.id=uniqueid()),i.hasAttribute("media-carousel")?(e=new autoloader(`[id="${i.id}"]`,{Carousel:{slides:Array.from(i.querySelectorAll("img")).map((t=>t.src)),captions:Array.from(i.querySelectorAll("img")).map((t=>t.getAttribute("data-caption")||t.alt))??[],controls:!!i.hasAttribute("controls")&&parseBoolean(i.getAttribute("controls"),!0),transition:i.hasAttribute("data-transition")?i.getAttribute("data-transition"):"none",indicator:!!i.hasAttribute("data-indicator")&&parseBoolean(i.getAttribute("data-indicator"),!0),speed:i.hasAttribute("data-speed")?parseInt(i.getAttribute("data-speed")):5,interval:i.hasAttribute("data-interval")?parseInt(i.getAttribute("data-interval")):3e3,autoplay:!i.hasAttribute("autoplay")||parseBoolean(i.getAttribute("autoplay"),!0),loop:!i.hasAttribute("loop")||parseBoolean(i.getAttribute("loop"),!0)}},{Carousel:i.hasAttribute("data-styles")?Object.fromEntries(i.getAttribute("data-styles").split(";").map((t=>t.trim())).filter(Boolean).map((t=>{const[e,a]=t.split(":").map((t=>t.trim()));return[e,a]}))):{}}),i.querySelectorAll('img:not([class="image"])').forEach((t=>t.remove())),e.include(Carousel),e.use(Carousel).apply(),i.removeAttribute("data-slides"),i.removeAttribute("data-captions"),i.removeAttribute("data-transition"),i.removeAttribute("data-speed"),i.removeAttribute("data-interval"),i.removeAttribute("data-indicator"),i.removeAttribute("data-styles")):i.hasAttribute("media-gallery")?(t=new autoloader(`[id="${i.id}"]`,{Gallery:{images:Array.from(i.querySelectorAll("img")).map((t=>t.src)),captions:Array.from(i.querySelectorAll("img")).map((t=>t.getAttribute("data-caption")||t.alt))??[],static:!!i.hasAttribute("data-static")&&parseBoolean(i.getAttribute("data-static")),zoom:!!i.hasAttribute("data-zoom")&&parseBoolean(i.getAttribute("data-zoom")),autoResize:!i.hasAttribute("data-autoResize")||parseBoolean(i.getAttribute("data-autoResize"))}},{Gallery:i.hasAttribute("data-styles")?Object.fromEntries(i.getAttribute("data-styles").split(";").map((t=>t.trim())).filter(Boolean).map((t=>{const[e,a]=t.split(":").map((t=>t.trim()));return[e,a]}))):{}}),i.querySelectorAll('img:not([class="image"])').forEach((t=>t.remove())),t.include(Gallery),t.use(Gallery).apply(),i.removeAttribute("data-images"),i.removeAttribute("data-zoom"),i.removeAttribute("data-static"),i.removeAttribute("data-captions"),i.removeAttribute("data-autoResize"),i.removeAttribute("data-styles")):i.hasAttribute("media-video-player")?(a=new autoloader(`[id="${i.id}"]`,{VideoPlayer:{controls:!!i.hasAttribute("controls")&&parseBoolean(i.getAttribute("controls"),!0),loop:!!i.hasAttribute("loop")&&parseBoolean(i.getAttribute("loop"),!0),autoplay:!!i.hasAttribute("autoplay")&&parseBoolean(i.getAttribute("autoplay"),!0),muted:!!i.hasAttribute("muted")&&parseBoolean(i.getAttribute("muted"),!0),playlists:(()=>{const t=i.querySelectorAll("videoplayer");let e=[];return t.length>0&&t.forEach((t=>{const a=t.querySelector("video");if(a){const r=Array.from(t.querySelectorAll("track")).map((t=>({src:t.getAttribute("src")?t.getAttribute("src").replace(/^\.\//,""):"",kind:t.getAttribute("kind")||"",srclang:t.getAttribute("srclang")||"",label:t.getAttribute("label")||""})));e.push({poster:a.getAttribute("poster")||"",title:t.getAttribute("title")||"",author:t.getAttribute("data-author")||"",src:Array.from(t.querySelectorAll("video")).map((t=>({quality:t.getAttribute("data-quality")||"auto",path:t.getAttribute("src")?t.getAttribute("src").replace(/^\.\//,""):""}))),tracks:Array.isArray(r)?r:[]})}})),e})()}},{VideoPlayer:i.hasAttribute("data-styles")?Object.fromEntries(i.getAttribute("data-styles").split(";").map((t=>t.trim())).filter(Boolean).map((t=>{const[e,a]=t.split(":").map((t=>t.trim()));return[e,a]}))):{}}),i.querySelectorAll("playlists").forEach((t=>t.remove())),a.include(VideoPlayer),a.use(VideoPlayer).apply(),i.removeAttribute("data-tracks"),i.removeAttribute("data-styles")):i.hasAttribute("media-audio-player")&&(r=new autoloader(`[id="${i.id}"]`,{AudioPlayer:{controls:!!i.hasAttribute("controls")&&parseBoolean(i.getAttribute("controls"),!0),loop:!!i.hasAttribute("loop")&&parseBoolean(i.getAttribute("loop"),!0),autoplay:!!i.hasAttribute("autoplay")&&parseBoolean(i.getAttribute("autoplay"),!0),muted:!!i.hasAttribute("muted")&&parseBoolean(i.getAttribute("muted"),!0),playlists:(()=>{const t=i.querySelectorAll("audioplayer");let e=[];return t.length>0&&t.forEach((t=>{if(t.querySelector("audio")){const a=Array.from(t.querySelectorAll("track")).map((t=>({src:t.getAttribute("src")?t.getAttribute("src").replace(/^\.\//,""):"",kind:t.getAttribute("kind")||"",srclang:t.getAttribute("srclang")||"",label:t.getAttribute("label")||""})));e.push({src:Array.from(t.querySelectorAll("audio")).map((e=>({path:e.getAttribute("src")?e.getAttribute("src").replace(/^\.\//,""):"",album:e.getAttribute("data-album")||t.getAttribute("data-album")||"",artist:e.getAttribute("data-artist")||t.getAttribute("data-artist")||"",img:e.getAttribute("data-img")||t.getAttribute("data-img")||"",title:e.getAttribute("data-title")||e.getAttribute("title")||t.getAttribute("data-title")||t.getAttribute("title")||""}))),tracks:Array.isArray(a)?a:[]})}})),e})()}},{AudioPlayer:i.hasAttribute("data-styles")?Object.fromEntries(i.getAttribute("data-styles").split(";").map((t=>t.trim())).filter(Boolean).map((t=>{const[e,a]=t.split(":").map((t=>t.trim()));return[e,a]}))):{}}),i.querySelectorAll("playlists").forEach((t=>t.remove())),r.include(AudioPlayer),r.use(AudioPlayer).apply(),i.removeAttribute("data-tracks"),i.removeAttribute("data-styles"))}))}));
